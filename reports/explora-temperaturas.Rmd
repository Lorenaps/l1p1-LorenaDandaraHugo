---
title: "Temperatura JP x CG"
output:
    html_document:
    df_print: paged
theme: sandstone
---

```{r echo=FALSE, message=FALSE, warning=FALSE}
library(tidyverse)
library(here)
library(lubridate)
library(ggbeeswarm)
library(ggplot2)
theme_set(theme_bw())
```

```{r}
climas = read_csv(here::here("data/clima_cg_jp-semanal.csv"), 
                  col_types = "cTdddddd")
```
## Perguntas sobre Temperatura

#### Onde é mais quente?

```{r}

climas_qt = climas %>% dplyr::select(mes, tmedia, tmax, tmin, chuva, cidade, ano) 

media_por_ano = climas_qt %>% 
                group_by(ano, cidade) %>% 
                summarise(mean_tmax = mean(x=tmax), mean_tmedia = mean(x=tmedia), mean_chuva = mean(x=chuva)) %>% 
                filter(ano > 1991) 

media_por_cidade = media_por_ano %>% 
                    group_by(cidade) %>% 
                    summarise(mean_tmax = mean(x=mean_tmax), mean_tmedia = mean(x=mean_tmedia), mean_chuva = mean(x=mean_chuva))
                                                                     
g_mes = climas_qt %>% group_by(ano, mes, cidade) %>% summarise(mean_tmax = mean(x=tmax))

ggplot(data = media_por_ano, mapping = aes(x = ano, y = mean_tmax, label=mean_tmax)) + 
                geom_line(aes(col=cidade), size=2) + 
                ggtitle("Média da temperatura máxima ao longo dos anos", subtitle="Entre Campina Grande e João Pessoa") + 
                xlab("Anos") + 
                ylab("Média Temperatura Máxima") +
                scale_x_continuous(breaks = seq(1992,2020,2))
```
```{r}
ggplot(data = media_por_cidade, mapping = aes(x = cidade, y = mean_tmax, label=mean_tmax)) + 
                geom_col(aes(fill=cidade), size=2) + 
                ggtitle("Média da temperatura anual entre 1991 e 2019", subtitle="Entre Campina Grande e João Pessoa") + 
                xlab("Cidades") + 
                ylab("Média da Temperatura Máxima") + 
                geom_label()
```

Calculando a média anual da temperatura máxima para cada cidade é possível visualizar o comportamento da temperatura ao longos dos anos. Observando essa primeira visualização é possível identificar como a temperatura de João Pessoa vem passando a temperatura de Campina Grande durante esse tempo. Uma vez que se considere a média de todos os anos chegamos aos valores da última visualização, sobre a qual podemos afirmar que João Pessoa apresenta a maior média e por isso pode ser considerada mais quente do que Campina Grande.

#### Quais os meses mais quentes e mais frios? 

```{r}

climas_qt = climas %>% dplyr::select(mes, tmedia, tmax, tmin, chuva) 

g_mes = climas_qt %>% group_by(mes) %>% summarise(mean_tmax = mean(x=tmax))

# ggplot(data = g_mes, mapping = aes(x = mes, y = mean_tmax)) + geom_point()

```
## Perguntas sobre Chuva

#### No geral, onde chove mais?

```{r}

climas_qt = climas %>% dplyr::select(mes, tmedia, tmax, tmin, chuva, cidade, ano) 

g_mes = climas_qt %>% group_by(mes) %>% summarise(mean_tmax = mean(x=tmax))


g_mes = climas_qt %>% group_by(mes) %>% summarise(mean_tmax = mean(x=tmax))

# ggplot(data = g_mes, mapping = aes(x = mes, y = mean_tmax)) + geom_point()

```

#### A distribuição é diferente em meses específicos? 

```{r}

climas_qt = climas %>% dplyr::select(mes, tmedia, tmax, tmin, chuva) 

g_mes = climas_qt %>% group_by(mes) %>% summarise(mean_tmax = mean(x=tmax))

# ggplot(data = g_mes, mapping = aes(x = mes, y = mean_tmax)) + geom_point()

```
